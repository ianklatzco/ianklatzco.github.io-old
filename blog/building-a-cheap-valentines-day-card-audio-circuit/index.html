
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Building a Cheap Valentine&#8217;s Day Card Audio Circuit - Not Your Average End User</title>
  <meta name="author" content="Ian Klatzco">

  
  <meta name="description" content="About two weeks before Valetine&rsquo;s Day, I got the idea of making a Zelda-themed card for a friend of mine. She and I are both big Zelda fans. I &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://klatz.co/blog/building-a-cheap-valentines-day-card-audio-circuit">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Not Your Average End User" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-46953705-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Not Your Average End User</a></h1>
  
    <h2>but rather a teenage geek with a fondness for computers, politics, and tinkering</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:klatz.co" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/projects">Projects</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Building a Cheap Valentine&#8217;s Day Card Audio Circuit</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-02-22T19:43:39-06:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2014</span></span> <span class='time'>7:43 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>About two weeks before Valetine&rsquo;s Day, I got the idea of making a Zelda-themed card for a friend of mine. She and I are both big Zelda fans. I searched the web for a  card, until I found <a href="(http://blog.close-encounters.com.au/2013/02/normal-0-false-false-false.html">this one</a> that I liked because of the extra dimensions. It seems that the pop-up style heart container card is a pretty popular one overall, and this is one of many.</p>

<p>I decided to take it another step, incoporating some of my (few) electronics skills into the project. To be honest, it was mostly an excuse to order some parts off of Digikey and super-nerdify what would otherwise be a fairly straightforward project. But hey! It was extraordinarily fun.</p>

<!-- more -->


<p>So did some research for recordable card circuits, and I found <a href="http://hackaday.com/2011/11/22/musical-greeting-card-with-minimal-parts/">this Hackaday post</a> about how to make one on my own. I&rsquo;d been to Digikey&rsquo;s website before, but I had never made an order. Consequently, I had no idea what I was in for. I decided to go through with the project, and ended up ordering all the parts about a week in advance. After a minor issue with shipping a lithium-ion battery through UPS and <em>actually finding everything</em>, I got the parts on the Thursday night before Valentine&rsquo;s Day. I had some debugging left to do, so it was a fairly long night. It was by all means worth it.</p>

<p>The card itself is a relatively simple papercraft model, with some space inside to fit components. I printed it on some cardstock and cut it using an exacto knife.</p>

<h4>About the code</h4>

<p>I had a bit of an educational experience working on the code. I&rsquo;m familiar with Javascript and Python, and I&rsquo;ve worked with Arduino before, but I&rsquo;d never before really wrote new components. I used a modified version of the <a href="http://www.arduino.cc/en/Tutorial/Melody">Arduino&rsquo;s Melody example code</a>. Initially, I tuned the values with a tuning application (Instuner on the App Store) for the piezo buzzer, and added flat/sharp notes, as well as some notes an octave up I&rsquo;d need to play the bit of music. The code, more or less the same but with tuned values, is <a href="https://github.com/ianklatzco/melody_revised">on GitHub</a>. I then manually wrote transcribed the notes from some sheet music of the specific tune into the code, resulting in <a href="https://github.com/ianklatzco/melody_revised/blob/master/zelda_chest_noise.ino">this</a>.</p>

<h4>Hardware and writing the code to the ATtiny</h4>

<p>The electronics components were a bit trickier. I ordered about $5 in parts (<a href="http://i.imgur.com/bJdj4Qz.png">parts list</a>) along with some spare ATtinies for future projects. Initially, I thought that I would use a piezo buzzer and reed switch in the circuit, but in the end I opted for a speaker I had on hand (16ohm, 0.5w, salvaged from a similar, pre-recorded greeting card with a ROM) and a regular (SPST) switch (salvaged from the inside of a vending machine). Here&rsquo;s a photo of the (poorly drawn) circuit diagram:
<img src="http://i.imgur.com/0ULfMSj.jpg" alt="circuit diagram" />
Here&rsquo;re some of the parts:
<img src="http://i.imgur.com/QpoaPIs.jpg" alt="parts" /></p>

<p>I connected pins 0 and 1 on the ATtiny to the speaker and switch, respectively. After soldering everything in place, I decided that the reed switch was too difficult to align, so I swapped it for the SPST. I wrote the final version of the code to the ATtiny (or so I thought), connected the battery, and everything looked like it was good to go.</p>

<p>Suddenly, an eerie croaking noise came out of the speaker, audibly changing tones but doing so very slowly. As it was already about midnight at that, I panicked. I guessed the issue was the clock rate on the chip â€” I tested the code on the Arduino, which boasts a 20MHz crystal (which actually runs at 16MHz most of the time), as opposed to the ATtiny, which has a paltry 1MHz. A quick google search found a <a href="http://electronics.stackexchange.com/questions/7859/how-do-i-set-the-clock-speed-fuses-on-an-attiny85-when-using-an-arduino-as-a-pro">Stack Exchange</a> post that told me that I should multiply all values by a factor of sixteen, which worked splendidly. The notes were out of tune, and the croaking sounds remained, but it wasn&rsquo;t nearly as bad as before. The final code is also <a href="https://github.com/ianklatzco/melody_revised/blob/master/zelda_chest_noise_x16.ino">on GitHub</a>.</p>

<h4>Using the Arduino as an ISP (to program the ATtiny)</h4>

<p><img src="http://i.imgur.com/mtKQXWc.jpg" alt="programming" />
In order to program the ATtiny, I used the Arduino. I followed the guide at <a href="http://highlowtech.org/?p=1695">highlowtech.org</a> and it worked, if not with a few hiccups. Initially, I was pushing the ATtiny and a socket down into the breadboard, before I realized that the ATTiny could be pushed directly into it.</p>

<h4>Final Product</h4>

<div class="embed-video-container"><iframe src="//www.youtube.com/embed/ansXraLD05M" allowfullscreen></iframe></div>


<p>I have to thank two friends of mine, who provided awesome help throughout this project. Both who work in the tech industry. If you&rsquo;re a high school student, you should definitely try to communicate with professionals who work in positions you&rsquo;d like to have. If you&rsquo;re a professional, you should be open to helping kids pursue their interests. The relationships I&rsquo;ve developed have been extremely beneficial.</p>

<hr />

<h4>Hilarious Side Note</h4>

<p>Listening to serial communication is the coolest thing ever. It sounds a bit like a dial-up modem.</p>

<div class="embed-video-container"><iframe src="//www.youtube.com/embed/nlxuCgJxEsg" allowfullscreen></iframe></div>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Ian Klatzco</span></span>

      




<time class='entry-date' datetime='2014-02-22T19:43:39-06:00'><span class='date'><span class='date-month'>Feb</span> <span class='date-day'>22</span><span class='date-suffix'>nd</span>, <span class='date-year'>2014</span></span> <span class='time'>7:43 pm</span></time>
      


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/accessing-the-admin-panel-on-coke-freestyle-machines/" title="Previous Post: Accessing the Admin panel on Coke Freestyle Machines">&laquo; Accessing the Admin panel on Coke Freestyle Machines</a>
      
      
        <a class="basic-alignment right" href="/blog/playing-with-the-experiment-on-google-ios-site/" title="Next Post: Playing with the Experiment on Google IO's site">Playing with the Experiment on Google IO&#8217;s site &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>About Me</h1>
  <p>Hi! I&#8217;m Ian Klatzco. I like computers, governments, the maker movement, virtual reality, and security.<a href="/about">More</a></p>

</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/devocalizer-box/">Song Devocalizer Box</a>
      </li>
    
      <li class="post">
        <a href="/blog/terraria-backup-script/">How to Automatically Back Up Terraria Saves/Worlds With a Script</a>
      </li>
    
      <li class="post">
        <a href="/blog/floppera/">Floppera</a>
      </li>
    
      <li class="post">
        <a href="/blog/google-tour/">Google Tour</a>
      </li>
    
      <li class="post">
        <a href="/blog/raspberry-pi-nes-pc/">Raspberry Pi: NES-PC</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Elsewhere</h1>
  	You can find me as iananananan or ianklatzco on most services that I use.
</section>




  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Ian Klatzco -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
